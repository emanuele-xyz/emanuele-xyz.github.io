<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BRDFs</title>

    <!-- LaTeX.css -->
    <link rel="stylesheet" href="https://latex.vercel.app/style.min.css" />

    <!-- KaTeX CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

    <!-- Force light theme -->
    <style>
        html {
            color-scheme: light;
        }
    </style>

    <!-- KaTeX JS (auto-render) -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body);"></script>

</head>

<body>

    <hr>
    <nav>
        <div style="text-align: center;">
            <a href="../../index.html">Home</a>
            <a href="https://github.com/emanuele-xyz" target="_blank">GitHub</a>
        </div>
    </nav>
    <hr>

    <section>
        <h1>BRDFs 'til I collapse</h1>
        <p><em>Posted on June 02, 2025</em> - <em>Updated on June 05, 2025</em></p>
    </section>

    <section>
        <h2>Index</h2>
        <ul>
            <li><a href="#intro">Introduction</a></li>
            <li><a href="#rendering-equation">The rendering equation</a></li>
            <li><a href="#brdf">BRDF</a></li>
            <ul>
                <li><a href="#brdf-positivity">Positivity</a></li>
                <li><a href="#brdf-reciprocity">Helmholtz Reciprocity</a></li>
                <li><a href="#brdf-energy-conservation">Energy Conservation</a></li>
            </ul>
            <li><a href="#biblio">Bibliography</a></li>
        </ul>
    </section>

    <section id="intro">
        <h2>Introduction</h2>
        <p>
            The aim of this work is to to present to the uninitiated what a BRDF is. We follow this discussion by
            discussing the most notorious BRDFs in the literature. Each BRDF is also implemented through a graphics API.
        </p>
    </section>

    <section id="rendering-equation">
        <h2>The rendering equation</h2>
        <p>
            Before discussing what is a BRDF, we need to take a step back and spend some time talking about the
            rendering equation. We do this because BRDFs are one piece of the picture painted by the rendering equation.
        </p>
        <p>
            The rendering equation, as was introduced by Kajiya in 1986 <a href="#[1]">[1]</a>, is presented below.
        </p>
        <div style="overflow: auto;">
            $$ I(x, x') = g(x, x') \left[ \epsilon(x, x') + \int_S \rho(x, x', x'') I(x', x'') \, dx'' \right] $$
        </div>
        <ul>
            <li>\( I(x, x') \) is the light going from point \(x'\) to point \(x\).</li>
            <li>\( g(x, x') \) is a geometry term. This term represents occlusion.</li>
            <li>\( g(x, x') = 0 \) when points \(x\) and \(x'\) are not mutually visible. </li>
            <li>\( g(x, x') = \frac{1}{r^2} \) when points \(x\) and \(x'\) are mutually visible.</li>
            <li>\(r\) is the distance between points \(x\) and \(x'\).</li>
            <li>\( \epsilon(x, x') \) is the emitted light going from point \(x'\) to point \(x\).</li>
            <li>\(S\) is the set of all surface points in the scene.</li>
            <li>\( x, x', x'' \in S \) are surface points.</li>
            <li>\( \rho(x, x', x'') \) is the light reflected from point \(x''\) to point \(x\) by point \(x'\).</li>
        </ul>
        <p>
            This equation states that the light going from \(x'\) to \(x\) is the sum of the emitted
            light from \(x'\) to \(x\) and the total light that is reflected toward \(x\), by \(x'\), from all other
            surface points.
        </p>
        <p>
            Another form for the rendering equation, and the one that you will most probably find in the literature, is
            the following.
        </p>
        <div style="overflow: auto;">
            $$ L_o(x, \omega_o) = L_e(x, \omega_o) + \int_{\Omega} f_r(x, \omega_i, \omega_o) \, L_i(x, \omega_i) \,
            (\omega_i \cdot n) \, \mathrm{d}\omega_i $$
        </div>
        <ul>
            <li>
                \(L_o(x, \omega_o)\) is the outgoing light, from point \(x\), along direction \(\omega_o\).
            </li>
            <li>
                \(L_e(x, \omega_o)\) is the emitted light, from point \(x\), along direction \(\omega_o\).
            </li>
            <li>\(\Omega\) is the unit hemisphere centered along \(n\).</li>
            <li>\(n\) is the surface normal at point \(x\).</li>
            <li>\(\omega_i \in \Omega\) is a negated direction for possible incoming light.</li>
            <li>
                \(f_r(x, \omega_i, \omega_o)\) is the proportion of light, reflected from \(\omega_i\) toward
                \(\omega_o\), at position \(x\).
            </li>
            <li>
                \(L_i(x, \omega_i)\) is the incoming light, toward point \(x\), from direction \(\omega_i\).
            </li>
            <li>
                \(\omega_i \cdot n\) is the cosine of the angle between \(\omega_i\) and \(n\). It is
                used as a weighting term and represents the fact that the intensity of reflected light from a surface is
                proportional to the cosine of the angle between the negated light direction and the surface normal. This
                is Lambert's cosine law.
            </li>
        </ul>
        <p>
            This form of the rendering equation follows the same idea as the one presented above. It states that the
            amount of light going out of point \(x\), along direction \(\omega_o\), is the sum of the light emitted by
            \(x\), along \(\omega_o\), and the reflected light at \(x\), along direction \(\omega_o\).
        </p>
        <figure style="display: table; margin: 1em auto; text-align: center;">
            <img src="rendering_equation.svg" alt="rendering equation" style="max-width: 100%; height: auto;">
            <figcaption>Rendering equation.</figcaption>
        </figure>
        <p>
            The rendering equation is what unifies all various rendering algorithms. As you may guess, light is a
            central aspect of rendering, especially if we want our rendering to be believable, plausible, or even
            physically accurate. Any non trivial rendering algorithm is, in some way, trying to simulate how light
            works, how light behaves and interacts with matter. This means that it is trying to solve the rendering
            equation. More precisely, it is trying to find a solution to the rendering equation. Solution that, in most
            cases, either cannot be found, because it doesn't exist, or it would be too complex to do so. Thus, what
            rendering algorithms find when trying to solve the rendering equation is just an approximate solution. One
            that, nonetheless, yields satisfying results.
        </p>
    </section>

    <section id="brdf">
        <h2>BRDF</h2>
        <p>
            Having discussed the rendering equation, we have already met the bidirectional reflectance
            distribution function, or BRDF for short. In the first form of the rendering equation, the BRDF is
            represented by function \( \rho(x, x', x'') \). In the second form of the rendering equation, the BRDF is
            represented by function \(f_r(x, \omega_i, \omega_o)\). We can see that, in both forms, the BRDF defines how
            light is reflected off a surface.
        </p>
        <p>
            The idea of the BRDF was first presented by Nicodemus, in 1965 <a href="#[2]">[2]</a>. The BRDF is defined
            as the ratio between reflected radiance along direction \(\omega_o\) and incoming irradiance, incident on
            surface point \(x\), coming from direction \(\omega_i\). For simplicity's sake, you can imagine the BRDF to
            be the ratio of outgoing and incoming light, the first along direction \(\omega_o\), the second along
            direction \(\omega_i\), at surface point \(x\).
        </p>
        <p>
            Any implementation of the BRDF that would like to be physically plausible, i.e.
            respect the laws of physics, must satisfy the following three properties: positivity, Helmholtz reciprocity
            and energy conservation <a href="#[3]">[3]</a>.
        </p>

        <section id="brdf-positivity">
            <h3>Positivity</h3>

            <p>
                The BRDF must always be positive. Negative reflectance is not allowed.
            </p>

            <div style="overflow: auto;">
                $$ f_r(x, \omega_i, \omega_o) \geq 0 $$
            </div>
        </section>

        <section id="brdf-reciprocity">
            <h3>Helmholtz Reciprocity</h3>

            <p>
                The BRDF must follow Helmholtz reciprocity principle. This means that, if we were to swap the incoming
                and outgoing directions, the reflectance would be the same.
            </p>

            <div style="overflow: auto;">
                $$ f_r(x, \omega_i, \omega_o) = f_r(x, \omega_o, \omega_i) $$
            </div>
        </section>

        <section id="brdf-energy-conservation">
            <h3>Energy Conservation</h3>

            <p>
                The BRDF must follow the law of conservation of energy, i.e. energy can neither be created nor
                destroyed. Since we are talking about light, this law is saying that the amount of outgoing light cannot
                be greater than the amount of incoming light.
            </p>

            <p>
                Energy conservation for the BRDF is often formalized as follows.
            </p>

            <div style="overflow: auto;">
                $$ \int_{\Omega} f_r(x, \omega_i, \omega_o) \, (\omega_i \cdot n) \, \mathrm{d}\omega_i \le 1 $$
            </div>
        </section>
    </section>

    <section id="biblio">
        <h2>Bibliography</h2>
        <ul>
            <li id="[1]">
                <a href="https://www.cs.cmu.edu/afs/cs/academic/class/15462-s13/www/lec_slides/86kajiyaRenderingEquation.pdf"
                    target="_blank" rel="noopener noreferrer">
                    [1] The Rendering Equation, Kajiya 1986
                </a>
            </li>
            <li id="[2]">
                [2] Directional Reflectance and Emissivity of an Opaque Surface, Nicodemus 1965 [DOI:
                10.1364/AO.4.000767]
            </li>
            <li id="[3]">
                [3] Numerical Verification of Bidirectional Reflectance Distribution Functions for Physical
                Plausibility, Duvenhage, Bouatouch, Kourie 2013 [DOI: 10.1145/2513456.2513499]
            </li>
        </ul>
    </section>

</body>

</html>
